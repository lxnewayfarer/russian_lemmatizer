# Russian lemmatizer

Лемматизация — процесс приведения словоформы к лемме — её нормальной (словарной) форме.

Этот гем является, в своем роде, ультимативным решением, так как используемый словарь словоформ содержит ~6 млн. словоформ русского языка.

## Принцип работы
1. Текст или слово очищается от знаков препинания и переводится в верхний регистр. Буква "Ё" заменяется буквой "Е".
2. Затем, проводится поиск этой словоформы в хранилище Redis (подробнее об этом в пункте "Зависимости"), где они хранятся в виде ключ-значение, где ключ - это словоформа, а значение - его лемма, то есть начальная форма.

## Использование
Для использования, необходимо создать экземпляр класса. Далее доступны методы lemmatize - приведение к нормальной форме предложения, представленного в виде строки или массива, tokenize - очистка строки или массива от знаков препинания и get_lemma - получение леммы для одного русского слова. Пример:
```ruby
require "russian_lemmatizer"

lemmatizer = RussianLemmatizer.new

lemmatizer.lemmatize("Лемматизация — процесс приведения словоформы к лемме — её нормальной (словарной) форме.")
> ["ЛЕММАТИЗАЦИЯ", "ПРОЦЕСС", "ПРИВЕДЕНИЕ", "СЛОВОФОРМА", "К", "ЛЕММА", "ОНА", "НОРМАЛЬНЫЙ", "СЛОВАРНЫЙ", "ФОРМА"]
```
Пример использования представлен в `example.rb`

## Зависимости
Так как средство рассчитано под большой объем данных в словаре, для быстрого доступа к данным используется Redis. Класс использует хост и порт по умолчанию *localhost:6379*. Есть возможность создать класс с пользовательским подключением к Redis:
```ruby
redis_config = {
    host: "10.0.1.1",
    port: 6380,
    db: 15
}

# Alternatively 
# redis_config = { url: "redis://:p4ssw0rd@10.0.1.1:6380/15" }

lemmatizer = RussianLemmatizer.new(redis_config: redis_config)
```
Благодаря использованию Redis, лемматизация текста в 1000 слов происходит в среднем за 0.2 сек. В то время как лемматизация лишь одного слова при поиске по текстовому файлу займет до 8 сек.
При создании класса, проверяется наличие ключа в Redis. Если ключ отсутствуют, то данные подгружаются из текстового словаря. Этот процесс может занять некоторое время. 

## Где взять словарь
OpenCorpora — это проект по созданию размеченного корпуса текстов силами сообщества. Корпус будет доступен бесплатно и в полном объёме (под лицензией CC-BY-SA). 

http://opencorpora.org/dict.php

Для использования этого корпуса, необходимо скачать текстовый вариант (.txt), и при создании экземпляра, указать путь до словаря:
```ruby
lemmatizer = RussianLemmatizer.new(dictionary_path: "./data/dict.opcorpora.txt")
```
Гем разработан для использования словаря исключительно со структурой, предоставляемой OpenCorpora в текстовом варианте словаря.

## Разработка и тестирование
Для разработки использовался docker-compose с Redis с параметрами по-умолчанию.

Rspec тестами покрыты методы `get_lemma`, `tokenize` и `lemmatize`. Глаголы, существительные и прилагательные отрабатывают корректно в любой форме.
Для запуска тестов запустить
```
% rspec
```

Для сборки гема локально:
```
% gem build russian_lemmatizer.gemspec 
Successfully built RubyGem
Name: russian_lemmatizer
Version: 0.1.0
File: russian_lemmatizer-0.1.0.gem
```
Для локальной установки гема, использовать:
```
% gem install ./hola-0.0.0.gem
```
После чего, гем будет доступен локально:
```
% irb
>> require 'russian_lemmatizer'
=> true
```